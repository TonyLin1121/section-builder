# 參數檔維護功能規格說明書

| 項目 | 內容 |
|------|------|
| 文件編號 | SRS-COD-001 |
| 版本 | 1.0 |
| 建立日期 | 2026-01-20 |
| 作者 | System Analyst |
| 狀態 | 已核准 |

---

## 1. 文件簡介

### 1.1 目的

本文件詳細描述「參數檔維護」功能的完整需求規格，供開發人員依據本文件進行系統設計與實作。

### 1.2 範圍

本功能涵蓋系統參數代碼的新增、查詢、修改、刪除（CRUD）操作，用於維護系統中的各種代碼對照表。

### 1.3 名詞定義

| 名詞 | 說明 |
|------|------|
| 主分類代碼 (code_code) | 參數的主要分類代碼 |
| 子分類代碼 (code_subcode) | 參數的細項代碼 |
| 複合主鍵 | code_code + code_subcode |

---

## 2. 功能概述

### 2.1 功能目的

維護系統中使用的各種代碼對照表，如假別代碼、狀態代碼等，提供統一的參數管理機制。

### 2.2 功能架構

```
參數檔維護
├── 參數清單
│   ├── 列表展示
│   ├── 主分類/使用標記篩選
│   ├── 分頁排序
│   └── 資料匯出
├── 新增參數
├── 編輯參數
└── 刪除參數
```

### 2.3 主要參數類別

| code_code | 說明 |
|-----------|------|
| 0001 | 假別 |
| 0002 | 其他參數... |

---

## 3. 功能需求

### 3.1 參數清單查詢 (FR-001)

#### 3.1.1 輸入條件

| 參數名稱 | 資料型態 | 必填 | 說明 |
|----------|----------|------|------|
| code_code | string | 否 | 主分類代碼篩選 |
| used_mark | string | 否 | 使用標記篩選（0/1） |
| page | integer | 否 | 頁碼 |
| page_size | integer | 否 | 每頁筆數 |
| sort_by | string | 否 | 排序欄位 |
| sort_order | string | 否 | 排序方向 |

#### 3.1.2 可排序欄位

- code_code（主分類代碼）
- code_subcode（子分類代碼）
- code_subname（子分類名稱）
- upddate（更新日期）
- used_mark（使用標記）

---

### 3.2 新增參數 (FR-002)

#### 3.2.1 輸入欄位

| 欄位名稱 | 資料型態 | 必填 | 說明 |
|----------|----------|------|------|
| code_code | string(4) | ✓ | 主分類代碼 |
| code_subcode | string(4) | ✓ | 子分類代碼 |
| code_subname | string(20) | - | 子分類名稱 |
| code_content | string(100) | - | 內容說明 |
| sysmark | string(1) | - | 系統標記 |
| used_mark | string(1) | - | 使用標記（0:停用 1:啟用） |
| upd_userid | string(10) | - | 更新者 |
| remark | string(30) | - | 備註 |

#### 3.2.2 自動欄位

- upddate：自動設為當前日期（YYYYMMDD）
- updtime：自動設為當前時間（HHMMSS）

---

### 3.3 編輯參數 (FR-003)

#### 3.3.1 可編輯欄位

- code_subname（子分類名稱）
- code_content（內容說明）
- used_mark（使用標記）
- remark（備註）

#### 3.3.2 不可編輯欄位（主鍵）

- code_code、code_subcode

---

### 3.4 刪除參數 (FR-004)

使用複合主鍵：code_code + code_subcode

---

### 3.5 取得假別清單 (FR-005)

#### 3.5.1 功能描述

提供其他功能（如請假維護）取得有效假別清單的 API。

#### 3.5.2 處理邏輯

查詢 code_code='0001' 且 used_mark='1' 的參數。

---

## 4. 資料規格

### 4.1 資料表結構

**資料表名稱：** `gen001_allcode`

| 欄位名稱 | 資料型態 | 主鍵 | 允許 NULL | 說明 |
|----------|----------|------|-----------|------|
| code_code | VARCHAR(4) | ✓ | 否 | 主分類代碼 |
| code_subcode | VARCHAR(4) | ✓ | 否 | 子分類代碼 |
| code_subname | VARCHAR(20) | - | 是 | 子分類名稱 |
| code_content | VARCHAR(100) | - | 是 | 內容說明 |
| sysmark | VARCHAR(1) | - | 是 | 系統標記 |
| used_mark | VARCHAR(1) | - | 是 | 使用標記 |
| upd_userid | VARCHAR(10) | - | 是 | 更新者 |
| chk_userid | VARCHAR(10) | - | 是 | 檢查者 |
| upddate | VARCHAR(8) | - | 是 | 更新日期 |
| updtime | VARCHAR(8) | - | 是 | 更新時間 |
| remark | VARCHAR(30) | - | 是 | 備註 |

---

## 5. 介面規格

### 5.1 頁面佈局

```
┌──────────────────────────────────────────────────────────────┐
│ Header: ⚙️ 參數檔維護     [重新載入] [匯出 ▼]                 │
├──────────────────────────────────────────────────────────────┤
│ Form: 新增/編輯參數                                           │
│ [主分類代碼*] [子分類代碼*] [子分類名稱] [內容說明]           │
│ [系統標記] [使用標記▼] [備註]                                 │
├──────────────────────────────────────────────────────────────┤
│ Search: 參數清單                                              │
│ [主分類▼] [使用標記▼]                                        │
├──────────────────────────────────────────────────────────────┤
│ Table: 主分類 | 子分類 | 名稱 | 說明 | 更新日期 | 狀態 | 操作 │
└──────────────────────────────────────────────────────────────┘
```

### 5.2 使用標記顯示

| 值 | 顯示 | 樣式 |
|----|------|------|
| 1 | 啟用 | 綠色 |
| 0 | 停用 | 灰色 |

---

## 6. API 規格

| 端點 | 方法 | 說明 |
|------|------|------|
| `/api/codes` | GET | 取得參數清單 |
| `/api/codes/leave-types` | GET | 取得假別清單 |
| `/api/codes/{code_code}/{code_subcode}` | GET | 取得單一參數 |
| `/api/codes` | POST | 新增參數 |
| `/api/codes/{code_code}/{code_subcode}` | PUT | 更新參數 |
| `/api/codes/{code_code}/{code_subcode}` | DELETE | 刪除參數 |

---

## 7. 商業規則

| 規則編號 | 規則描述 |
|----------|----------|
| BR-001 | 複合主鍵 (code_code + code_subcode) 不可重複 |
| BR-002 | 主分類/子分類代碼最大 4 字元 |
| BR-003 | 更新時自動記錄更新日期和時間 |
| BR-004 | 假別清單僅回傳 used_mark='1' 的有效記錄 |

---

## 8. 錯誤處理

| 錯誤代碼 | 中文訊息 |
|----------|----------|
| CODE_NOT_FOUND | 參數不存在 |
| CODE_EXISTS | 此參數已存在 |

---

## 附錄：變更歷史

| 版本 | 日期 | 作者 | 變更說明 |
|------|------|------|----------|
| 1.0 | 2026-01-20 | SA | 初版建立 |
