# è«‹å‡ç¶­è­·åŠŸèƒ½è¦æ ¼èªªæ˜Žæ›¸

| é …ç›® | å…§å®¹ |
|------|------|
| æ–‡ä»¶ç·¨è™Ÿ | SRS-ATT-001 |
| ç‰ˆæœ¬ | 1.0 |
| å»ºç«‹æ—¥æœŸ | 2026-01-20 |
| ä½œè€… | System Analyst |
| ç‹€æ…‹ | å·²æ ¸å‡† |

---

## 1. æ–‡ä»¶ç°¡ä»‹

### 1.1 ç›®çš„

æœ¬æ–‡ä»¶è©³ç´°æè¿°ã€Œè«‹å‡ç¶­è­·ã€åŠŸèƒ½çš„å®Œæ•´éœ€æ±‚è¦æ ¼ï¼Œä¾›é–‹ç™¼äººå“¡ä¾æ“šæœ¬æ–‡ä»¶é€²è¡Œç³»çµ±è¨­è¨ˆèˆ‡å¯¦ä½œã€‚

### 1.2 ç¯„åœ

æœ¬åŠŸèƒ½æ¶µè“‹å“¡å·¥è«‹å‡è¨˜éŒ„çš„æ–°å¢žã€æŸ¥è©¢ã€ä¿®æ”¹ã€åˆªé™¤ï¼ˆCRUDï¼‰æ“ä½œï¼Œä»¥åŠè³‡æ–™åŒ¯å‡ºåŠŸèƒ½ã€‚

### 1.3 åè©žå®šç¾©

| åè©ž | èªªæ˜Ž |
|------|------|
| è«‹å‡æ—¥æœŸ (leave_date) | è«‹å‡çš„æ—¥æœŸï¼Œæ ¼å¼ç‚º YYYYMMDD |
| å‡åˆ¥ (leave_type) | è«‹å‡é¡žåž‹ä»£ç¢¼ï¼Œå°æ‡‰åƒæ•¸æª” code_code='0001' |
| è¤‡åˆä¸»éµ | emp_id + leave_date + leave_type |

---

## 2. åŠŸèƒ½æ¦‚è¿°

### 2.1 åŠŸèƒ½ç›®çš„

æä¾›ä¼æ¥­å…§éƒ¨è«‹å‡è¨˜éŒ„ç®¡ç†ç³»çµ±ï¼Œç¶­è­·å“¡å·¥è«‹å‡è³‡æ–™ï¼Œæ”¯æ´æ—¥æœŸç¯„åœæŸ¥è©¢èˆ‡è³‡æ–™åŒ¯å‡ºã€‚

### 2.2 åŠŸèƒ½æž¶æ§‹

```
è«‹å‡ç¶­è­·
â”œâ”€â”€ è«‹å‡è¨˜éŒ„æ¸…å–®
â”‚   â”œâ”€â”€ åˆ—è¡¨å±•ç¤ºï¼ˆå«å“¡å·¥å§“åï¼‰
â”‚   â”œâ”€â”€ å¤šç¶­åº¦ç¯©é¸
â”‚   â”œâ”€â”€ åˆ†é æŽ’åº
â”‚   â””â”€â”€ è³‡æ–™åŒ¯å‡º
â”œâ”€â”€ æ–°å¢žè«‹å‡è¨˜éŒ„
â”‚   â””â”€â”€ å“¡å·¥é¸æ“‡ â†’ æ—¥æœŸ/å‡åˆ¥è¼¸å…¥ â†’ è³‡æ–™é©—è­‰ â†’ å„²å­˜
â”œâ”€â”€ ç·¨è¼¯è«‹å‡è¨˜éŒ„
â”‚   â””â”€â”€ è¼‰å…¥è³‡æ–™ â†’ ä¿®æ”¹å¯ç·¨è¼¯æ¬„ä½ â†’ æ›´æ–°
â””â”€â”€ åˆªé™¤è«‹å‡è¨˜éŒ„
    â””â”€â”€ ç¢ºèªåˆªé™¤ â†’ åŸ·è¡Œåˆªé™¤
```

### 2.3 ä½¿ç”¨æƒ…å¢ƒ

| æƒ…å¢ƒç·¨è™Ÿ | æƒ…å¢ƒæè¿° |
|----------|----------|
| UC-001 | äººè³‡äººå“¡æ–°å¢žå“¡å·¥è«‹å‡è¨˜éŒ„ |
| UC-002 | äººè³‡äººå“¡ä¿®æ”¹è«‹å‡å¤©æ•¸æˆ–ä»£ç†äºº |
| UC-003 | äººè³‡äººå“¡åˆªé™¤éŒ¯èª¤çš„è«‹å‡è¨˜éŒ„ |
| UC-004 | ä¸»ç®¡æŸ¥è©¢ç‰¹å®šå“¡å·¥çš„è«‹å‡è¨˜éŒ„ |
| UC-005 | äººè³‡äººå“¡æŸ¥è©¢ç‰¹å®šæ—¥æœŸç¯„åœçš„æ‰€æœ‰è«‹å‡è¨˜éŒ„ |

---

## 3. ä½¿ç”¨è€…è§’è‰²

| è§’è‰² | æ¬Šé™èªªæ˜Ž |
|------|----------|
| ä¸€èˆ¬ä½¿ç”¨è€… | å¯æŸ¥è©¢è«‹å‡è¨˜éŒ„ã€åŒ¯å‡ºè³‡æ–™ |
| ç®¡ç†å“¡ | å¯åŸ·è¡Œæ‰€æœ‰ CRUD æ“ä½œ |

---

## 4. åŠŸèƒ½éœ€æ±‚

### 4.1 è«‹å‡è¨˜éŒ„æ¸…å–®æŸ¥è©¢ (FR-001)

#### 4.1.1 åŠŸèƒ½æè¿°

é¡¯ç¤ºè«‹å‡è¨˜éŒ„åˆ—è¡¨ï¼Œæ”¯æ´å¤šç¶­åº¦ç¯©é¸ã€åˆ†é èˆ‡æŽ’åºåŠŸèƒ½ã€‚

#### 4.1.2 è¼¸å…¥æ¢ä»¶

| åƒæ•¸åç¨± | è³‡æ–™åž‹æ…‹ | å¿…å¡« | èªªæ˜Ž |
|----------|----------|------|------|
| emp_id | string | å¦ | å“¡å·¥ç·¨è™Ÿç¯©é¸ |
| emp_name | string | å¦ | å“¡å·¥å§“åç¯©é¸ï¼ˆæ¨¡ç³Šæ¯”å°ï¼‰ |
| leave_type | string | å¦ | å‡åˆ¥ç¯©é¸ |
| start_date | string | å¦ | é–‹å§‹æ—¥æœŸ YYYYMMDD |
| end_date | string | å¦ | çµæŸæ—¥æœŸ YYYYMMDD |
| page | integer | å¦ | é ç¢¼ï¼ˆé è¨­ 1ï¼‰ |
| page_size | integer | å¦ | æ¯é ç­†æ•¸ï¼ˆé è¨­ 20ï¼‰ |
| sort_by | string | å¦ | æŽ’åºæ¬„ä½ |
| sort_order | string | å¦ | æŽ’åºæ–¹å‘ï¼ˆasc/descï¼Œé è¨­ descï¼‰ |

#### 4.1.3 è¼¸å‡ºçµæžœ

| æ¬„ä½åç¨± | è³‡æ–™åž‹æ…‹ | èªªæ˜Ž |
|----------|----------|------|
| items | array | è«‹å‡è¨˜éŒ„é™£åˆ—ï¼ˆå«å“¡å·¥å§“åï¼‰ |
| total | integer | ç¸½ç­†æ•¸ |
| page | integer | ç•¶å‰é ç¢¼ |
| page_size | integer | æ¯é ç­†æ•¸ |
| total_pages | integer | ç¸½é æ•¸ |

#### 4.1.4 è™•ç†é‚è¼¯

1. LEFT JOIN member è³‡æ–™è¡¨å–å¾—å“¡å·¥å§“å
2. æ ¹æ“šç¯©é¸æ¢ä»¶çµ„åˆ WHERE å­å¥
3. æ—¥æœŸç¯„åœç¯©é¸ä½¿ç”¨ >= å’Œ <= æ¯”è¼ƒ
4. é è¨­ä¾è«‹å‡æ—¥æœŸé™åºæŽ’åˆ—

#### 4.1.5 å¯æŽ’åºæ¬„ä½

- emp_idï¼ˆå“¡å·¥ç·¨è™Ÿï¼‰
- leave_dateï¼ˆè«‹å‡æ—¥æœŸï¼‰
- leave_typeï¼ˆå‡åˆ¥ï¼‰
- duration_daysï¼ˆè«‹å‡å¤©æ•¸ï¼‰
- chinese_nameï¼ˆå“¡å·¥å§“åï¼‰

---

### 4.2 æ–°å¢žè«‹å‡è¨˜éŒ„ (FR-002)

#### 4.2.1 åŠŸèƒ½æè¿°

æ–°å¢žä¸€ç­†è«‹å‡è¨˜éŒ„è‡³è³‡æ–™åº«ã€‚

#### 4.2.2 è¼¸å…¥æ¬„ä½

| æ¬„ä½åç¨± | è³‡æ–™åž‹æ…‹ | å¿…å¡« | é©—è­‰è¦å‰‡ |
|----------|----------|------|----------|
| emp_id | string(12) | âœ“ | é ˆç‚ºæœ‰æ•ˆå“¡å·¥ç·¨è™Ÿ |
| leave_date | string(8) | âœ“ | æ ¼å¼ YYYYMMDD |
| leave_type | string(4) | âœ“ | é ˆç‚ºæœ‰æ•ˆå‡åˆ¥ä»£ç¢¼ |
| day_period | string(1) | - | 0:å¤© 1:ä¸Šåˆ 2:ä¸‹åˆ 3:å°æ™‚ |
| duration_days | float | - | è«‹å‡å¤©æ•¸ï¼ˆå¦‚ 0.5ã€1ã€2ï¼‰ |
| substitute | string(50) | - | ä»£ç†äººå§“å |
| remark | string(255) | - | å‚™è¨» |

#### 4.2.3 è™•ç†é‚è¼¯

1. å‰ç«¯é©—è­‰å¿…å¡«æ¬„ä½
2. å‘¼å«å¾Œç«¯ API
3. å¾Œç«¯æª¢æŸ¥è¤‡åˆä¸»éµæ˜¯å¦å·²å­˜åœ¨ï¼ˆemp_id + leave_date + leave_typeï¼‰
4. è‹¥å­˜åœ¨ï¼Œå›žå‚³éŒ¯èª¤ã€Œæ­¤è«‹å‡è¨˜éŒ„å·²å­˜åœ¨ã€
5. è‹¥ä¸å­˜åœ¨ï¼ŒåŸ·è¡Œ INSERT ä¸¦å›žå‚³æ–°å¢žçš„è³‡æ–™

---

### 4.3 ç·¨è¼¯è«‹å‡è¨˜éŒ„ (FR-003)

#### 4.3.1 åŠŸèƒ½æè¿°

ä¿®æ”¹æ—¢æœ‰è«‹å‡è¨˜éŒ„çš„éžä¸»éµæ¬„ä½ã€‚

#### 4.3.2 å¯ç·¨è¼¯æ¬„ä½

- day_periodï¼ˆè«‹å‡æ™‚æ®µï¼‰
- duration_daysï¼ˆè«‹å‡å¤©æ•¸ï¼‰
- substituteï¼ˆä»£ç†äººï¼‰
- remarkï¼ˆå‚™è¨»ï¼‰

#### 4.3.3 ä¸å¯ç·¨è¼¯æ¬„ä½ï¼ˆä¸»éµï¼‰

- emp_idï¼ˆå“¡å·¥ç·¨è™Ÿï¼‰
- leave_dateï¼ˆè«‹å‡æ—¥æœŸï¼‰
- leave_typeï¼ˆå‡åˆ¥ï¼‰

---

### 4.4 åˆªé™¤è«‹å‡è¨˜éŒ„ (FR-004)

#### 4.4.1 åŠŸèƒ½æè¿°

åˆªé™¤æŒ‡å®šçš„è«‹å‡è¨˜éŒ„ã€‚

#### 4.4.2 åˆªé™¤æ¢ä»¶

ä½¿ç”¨è¤‡åˆä¸»éµï¼šemp_id + leave_date + leave_type

---

### 4.5 è³‡æ–™åŒ¯å‡º (FR-005)

#### 4.5.1 åŒ¯å‡ºæ¬„ä½

| æ¬„ä½ | æ¨™é¡Œ | æ ¼å¼åŒ– |
|------|------|--------|
| emp_id | å“¡å·¥ç·¨è™Ÿ | - |
| chinese_name | å“¡å·¥å§“å | - |
| leave_date | è«‹å‡æ—¥æœŸ | è½‰æ›ç‚º YYYY/MM/DD |
| leave_type | å‡åˆ¥ | é¡¯ç¤ºå‡åˆ¥åç¨± |
| duration_days | è«‹å‡å¤©æ•¸ | - |
| substitute | ä»£ç†äºº | - |
| remark | å‚™è¨» | - |

---

## 5. è³‡æ–™è¦æ ¼

### 5.1 è³‡æ–™è¡¨çµæ§‹

**è³‡æ–™è¡¨åç¨±ï¼š** `member_attendance`

| æ¬„ä½åç¨± | è³‡æ–™åž‹æ…‹ | ä¸»éµ | å…è¨± NULL | èªªæ˜Ž |
|----------|----------|------|-----------|------|
| emp_id | VARCHAR(12) | âœ“ | å¦ | å“¡å·¥ç·¨è™Ÿ |
| leave_date | VARCHAR(8) | âœ“ | å¦ | è«‹å‡æ—¥æœŸ YYYYMMDD |
| leave_type | VARCHAR(4) | âœ“ | å¦ | å‡åˆ¥ä»£ç¢¼ |
| day_period | VARCHAR(1) | - | æ˜¯ | 0:å¤© 1:ä¸Šåˆ 2:ä¸‹åˆ 3:å°æ™‚ |
| duration_days | NUMERIC | - | æ˜¯ | è«‹å‡å¤©æ•¸ |
| job_logged | VARCHAR(1) | - | æ˜¯ | 0:æœªå¡« 1:å·²å¡« 2:å…å¡« |
| mynote_logged | VARCHAR(1) | - | æ˜¯ | 0:æœªå¡« 1:å·²å¡« 2:å…å¡« |
| substitute | VARCHAR(50) | - | æ˜¯ | ä»£ç†äºº |
| remark | VARCHAR(255) | - | æ˜¯ | å‚™è¨» |

---

## 6. ä»‹é¢è¦æ ¼

### 6.1 é é¢ä½ˆå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Header: ðŸ“… è«‹å‡ç¶­è­·     [é‡æ–°è¼‰å…¥] [åŒ¯å‡º â–¼]                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Form: æ–°å¢ž/ç·¨è¼¯è«‹å‡è¨˜éŒ„                                       â”‚
â”‚ [å“¡å·¥é¸æ“‡â–¼] [è«‹å‡æ—¥æœŸ] [å‡åˆ¥â–¼] [æ™‚æ®µâ–¼] [å¤©æ•¸] [ä»£ç†äºº] [å‚™è¨»] â”‚
â”‚                                      [å–æ¶ˆ] [æ–°å¢ž/æ›´æ–°]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Search: è«‹å‡è¨˜éŒ„æ¸…å–® (ç­†æ•¸)                                   â”‚
â”‚ [å“¡å·¥â–¼] [å‡åˆ¥â–¼] [é–‹å§‹æ—¥æœŸ] [çµæŸæ—¥æœŸ]                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Table: å“¡å·¥ç·¨è™Ÿ | å“¡å·¥å§“å | è«‹å‡æ—¥æœŸ | å‡åˆ¥ | å¤©æ•¸ | ä»£ç†äºº | æ“ä½œâ”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Pagination                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 å“¡å·¥é¸æ“‡çµ„ä»¶

ä½¿ç”¨ä¸‹æ‹‰é¸å–®é¸æ“‡å“¡å·¥ï¼Œé¡¯ç¤ºæ ¼å¼ï¼šã€Œå“¡å·¥ç·¨è™Ÿ - å“¡å·¥å§“åã€

---

## 7. API è¦æ ¼

### 7.1 å–å¾—è«‹å‡è¨˜éŒ„æ¸…å–®

| é …ç›® | è¦æ ¼ |
|------|------|
| ç«¯é»ž | `GET /api/attendance` |
| èªè­‰ | éœ€è¦ |

### 7.2 å–å¾—å–®ä¸€è«‹å‡è¨˜éŒ„

| é …ç›® | è¦æ ¼ |
|------|------|
| ç«¯é»ž | `GET /api/attendance/{emp_id}/{leave_date}/{leave_type}` |
| èªè­‰ | éœ€è¦ |

### 7.3 æ–°å¢žè«‹å‡è¨˜éŒ„

| é …ç›® | è¦æ ¼ |
|------|------|
| ç«¯é»ž | `POST /api/attendance` |
| èªè­‰ | éœ€è¦ |
| CSRF | éœ€è¦ |

### 7.4 æ›´æ–°è«‹å‡è¨˜éŒ„

| é …ç›® | è¦æ ¼ |
|------|------|
| ç«¯é»ž | `PUT /api/attendance/{emp_id}/{leave_date}/{leave_type}` |
| èªè­‰ | éœ€è¦ |
| CSRF | éœ€è¦ |

### 7.5 åˆªé™¤è«‹å‡è¨˜éŒ„

| é …ç›® | è¦æ ¼ |
|------|------|
| ç«¯é»ž | `DELETE /api/attendance/{emp_id}/{leave_date}/{leave_type}` |
| èªè­‰ | éœ€è¦ |
| CSRF | éœ€è¦ |

---

## 8. å•†æ¥­è¦å‰‡

| è¦å‰‡ç·¨è™Ÿ | è¦å‰‡æè¿° |
|----------|----------|
| BR-001 | è¤‡åˆä¸»éµ (emp_id + leave_date + leave_type) ä¸å¯é‡è¤‡ |
| BR-002 | åŒä¸€å“¡å·¥åŒä¸€å¤©å¯æœ‰å¤šç­†ä¸åŒå‡åˆ¥çš„è«‹å‡è¨˜éŒ„ |
| BR-003 | å‡åˆ¥éœ€åƒç…§åƒæ•¸æª” code_code='0001' çš„æœ‰æ•ˆä»£ç¢¼ |
| BR-004 | è«‹å‡å¤©æ•¸å¯ç‚ºå°æ•¸ï¼ˆå¦‚ 0.5 ä»£è¡¨åŠå¤©ï¼‰ |

---

## 9. éŒ¯èª¤è™•ç†

| éŒ¯èª¤ä»£ç¢¼ | ä¸­æ–‡è¨Šæ¯ |
|----------|----------|
| ATT_NOT_FOUND | è«‹å‡è¨˜éŒ„ä¸å­˜åœ¨ |
| ATT_EXISTS | æ­¤è«‹å‡è¨˜éŒ„å·²å­˜åœ¨ |
| INVALID_DATE | æ—¥æœŸæ ¼å¼ä¸æ­£ç¢º |

---

## é™„éŒ„ï¼šè®Šæ›´æ­·å²

| ç‰ˆæœ¬ | æ—¥æœŸ | ä½œè€… | è®Šæ›´èªªæ˜Ž |
|------|------|------|----------|
| 1.0 | 2026-01-20 | SA | åˆç‰ˆå»ºç«‹ |
