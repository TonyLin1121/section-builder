# 年假管理功能規格說明書

| 項目 | 內容 |
|------|------|
| 文件編號 | SRS-ANL-001 |
| 版本 | 1.0 |
| 建立日期 | 2026-01-20 |
| 作者 | System Analyst |
| 狀態 | 已核准 |

---

## 1. 文件簡介

### 1.1 目的

本文件詳細描述「年假管理」功能的完整需求規格，供開發人員依據本文件進行系統設計與實作。

### 1.2 範圍

本功能涵蓋員工年度假期額度的新增、查詢、修改、刪除（CRUD）操作。

### 1.3 名詞定義

| 名詞 | 說明 |
|------|------|
| 年度 (year) | 西元年度，格式為 4 位數字 |
| 假別 (leave_type) | 假期類型代碼 |
| 可休天數 (days_of_leave) | 該年度可使用的假期天數 |
| 複合主鍵 | emp_id + year + leave_type |

---

## 2. 功能概述

### 2.1 功能目的

管理員工各年度的假期額度，作為請假維護功能的基礎資料。

### 2.2 功能架構

```
年假管理
├── 年假記錄清單
│   ├── 列表展示（含員工姓名、假別名稱）
│   ├── 年度/員工/假別篩選
│   ├── 分頁排序
│   └── 資料匯出
├── 新增年假記錄
├── 編輯年假記錄
└── 刪除年假記錄
```

### 2.3 使用情境

| 情境編號 | 情境描述 |
|----------|----------|
| UC-001 | 人資人員設定新年度員工年假額度 |
| UC-002 | 人資人員調整員工年假天數 |
| UC-003 | 人資人員查詢特定員工各年度年假記錄 |

---

## 3. 功能需求

### 3.1 年假記錄清單查詢 (FR-001)

#### 3.1.1 輸入條件

| 參數名稱 | 資料型態 | 必填 | 說明 |
|----------|----------|------|------|
| emp_id | string | 否 | 員工編號篩選 |
| year | string | 否 | 年度篩選 |
| leave_type | string | 否 | 假別篩選 |
| page | integer | 否 | 頁碼 |
| page_size | integer | 否 | 每頁筆數 |
| sort_by | string | 否 | 排序欄位 |
| sort_order | string | 否 | 排序方向 |

#### 3.1.2 輸出結果

回傳分頁結果，每筆記錄包含員工姓名和假別名稱。

---

### 3.2 新增年假記錄 (FR-002)

#### 3.2.1 輸入欄位

| 欄位名稱 | 資料型態 | 必填 | 驗證規則 |
|----------|----------|------|----------|
| emp_id | string(12) | ✓ | 須為有效員工編號 |
| year | string(4) | ✓ | 4 位數西元年 |
| leave_type | string(4) | ✓ | 須為有效假別代碼 |
| days_of_leave | float | ✓ | 0 ~ 365.5 |
| remark | string(255) | - | 備註 |

#### 3.2.2 驗證規則

- 複合主鍵不可重複
- 可休天數範圍：0 ~ 365.5

---

### 3.3 編輯年假記錄 (FR-003)

#### 3.3.1 可編輯欄位

- days_of_leave（可休天數）
- remark（備註）

#### 3.3.2 不可編輯欄位（主鍵）

- emp_id、year、leave_type

---

### 3.4 刪除年假記錄 (FR-004)

使用複合主鍵：emp_id + year + leave_type

---

## 4. 資料規格

### 4.1 資料表結構

**資料表名稱：** `member_annual_leave`

| 欄位名稱 | 資料型態 | 主鍵 | 允許 NULL | 說明 |
|----------|----------|------|-----------|------|
| emp_id | VARCHAR(12) | ✓ | 否 | 員工編號 |
| year | VARCHAR(4) | ✓ | 否 | 西元年度 |
| leave_type | VARCHAR(4) | ✓ | 否 | 假別代碼 |
| days_of_leave | NUMERIC | - | 是 | 可休天數 |
| remark | VARCHAR(255) | - | 是 | 備註 |

---

## 5. 介面規格

### 5.1 頁面佈局

```
┌──────────────────────────────────────────────────────────────┐
│ Header: 🏖️ 年假管理     [重新載入] [匯出 ▼]                   │
├──────────────────────────────────────────────────────────────┤
│ Form: 新增/編輯年假記錄                                       │
│ [員工選擇▼] [年度] [假別▼] [可休天數] [備註]                 │
├──────────────────────────────────────────────────────────────┤
│ Search: 年假記錄清單                                          │
│ [員工▼] [年度▼] [假別▼]                                      │
├──────────────────────────────────────────────────────────────┤
│ Table: 員工編號 | 員工姓名 | 年度 | 假別 | 可休天數 | 操作    │
└──────────────────────────────────────────────────────────────┘
```

---

## 6. API 規格

| 端點 | 方法 | 說明 |
|------|------|------|
| `/api/annual-leave` | GET | 取得年假記錄清單 |
| `/api/annual-leave/{emp_id}/{year}/{leave_type}` | GET | 取得單一記錄 |
| `/api/annual-leave` | POST | 新增年假記錄 |
| `/api/annual-leave/{emp_id}/{year}/{leave_type}` | PUT | 更新年假記錄 |
| `/api/annual-leave/{emp_id}/{year}/{leave_type}` | DELETE | 刪除年假記錄 |

---

## 7. 商業規則

| 規則編號 | 規則描述 |
|----------|----------|
| BR-001 | 複合主鍵 (emp_id + year + leave_type) 不可重複 |
| BR-002 | 同一員工同一年度可有多種假別的年假額度 |
| BR-003 | 可休天數可為小數（如 7.5 天） |
| BR-004 | 可休天數範圍為 0 ~ 365.5 天 |

---

## 附錄：變更歷史

| 版本 | 日期 | 作者 | 變更說明 |
|------|------|------|----------|
| 1.0 | 2026-01-20 | SA | 初版建立 |
